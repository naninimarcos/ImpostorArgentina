<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Impostor - Juego de Detectives</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff0033">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Impostor">
    <link rel="apple-touch-icon" href="icons/icon-180.png">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16.png">

    <!-- Meta para SEO -->
    <meta name="description"
        content="Juego de detectives donde debes encontrar al impostor. ¡Perfecto para jugar con amigos!">
    <meta name="keywords" content="juego, impostor, detective, amigos, party game, argentina">
    <meta name="author" content="Impostor Game">

    <!-- Vercel Analytics -->
    <script>
        window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
    </script>
    <script defer src="https://cdn.vercel-insights.com/v1/script.debug.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: rgba(255, 255, 255, 0.15);
            --card-bg-solid: rgba(255, 255, 255, 0.95);
            --text-primary: #ffffff;
            --text-secondary: #1a1a1a;
            --accent-color: #ffeb3b;
            --success-color: #4caf50;
            --danger-color: #f44336;
            --button-primary: linear-gradient(45deg, #ff6b6b, #ee5a24);
            --button-secondary: linear-gradient(45deg, #74b9ff, #0984e3);
            --shadow-strong: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            --shadow-light: 0 4px 16px 0 rgba(31, 38, 135, 0.2);
        }

        @media (prefers-reduced-motion: reduce) {
            :root {
                --shadow-strong: 0 2px 8px 0 rgba(31, 38, 135, 0.2);
                --shadow-light: 0 1px 4px 0 rgba(31, 38, 135, 0.1);
            }

            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-primary);
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }

        /* Override completo para tema impostor */
        body.theme-impostor {
            background: radial-gradient(1200px 600px at 70% -20%, rgba(255, 43, 74, .18), transparent 60%),
                radial-gradient(900px 600px at -10% 110%, rgba(255, 122, 144, .12), transparent 60%),
                linear-gradient(180deg, #0b0b0f 0%, #0a0a0d 100%) !important;
            color: #e6e6ea !important;
        }

        .container {
            width: 90%;
            max-width: 400px;
            background: var(--card-bg);
            backdrop-filter: blur(8px);
            border-radius: 20px;
            padding: 30px;
            padding-bottom: calc(30px + env(safe-area-inset-bottom));
            box-shadow: var(--shadow-strong);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        /* Override específico del container para tema impostor */
        body.theme-impostor .container {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0.02)) !important;
            border: 1px solid rgba(255, 255, 255, 0.06) !important;
            box-shadow: 0 10px 40px rgba(0, 0, 0, .6) !important;
            backdrop-filter: blur(10px) !important;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Override para títulos en tema impostor */
        body.theme-impostor h1,
        body.theme-impostor h2 {
            color: #fff !important;
            letter-spacing: 0.5px !important;
        }

        body.theme-impostor h1 {
            font-size: 2.3rem !important;
            text-shadow: 0 0 12px rgba(255, 43, 74, .35) !important;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .game-description {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            line-height: 1.6;
            position: relative;
        }

        .instructions-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .instructions-header h3 {
            margin: 0;
        }

        .close-instructions {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            color: #fff;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            line-height: 1;
        }

        .close-instructions:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .close-instructions:active {
            transform: scale(0.95);
        }

        /* Override para tema impostor */
        body.theme-impostor .game-description {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0.02)) !important;
            border: 1px solid rgba(255, 255, 255, 0.06) !important;
            border-radius: 14px !important;
            box-shadow: 0 6px 24px rgba(0, 0, 0, .35) !important;
        }

        .theme-impostor .close-instructions {
            background: rgba(255, 43, 74, 0.2);
            border: 1px solid rgba(255, 43, 74, 0.3);
            color: #fff;
        }

        .theme-impostor .close-instructions:hover {
            background: rgba(255, 43, 74, 0.3);
            border-color: rgba(255, 43, 74, 0.5);
            box-shadow: 0 0 8px rgba(255, 43, 74, 0.3);
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        /* Override para labels en tema impostor */
        body.theme-impostor label {
            color: #a1a1b3 !important;
        }

        input,
        select {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 16px;
            font-weight: 500;
        }

        select {
            cursor: pointer;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23333' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            padding-right: 40px;
        }

        select option {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 10px;
            font-weight: 500;
        }

        /* Override para inputs en tema impostor */
        body.theme-impostor input,
        body.theme-impostor select {
            background: rgba(255, 255, 255, 0.08) !important;
            color: #e6e6ea !important;
            border: 1px solid rgba(255, 255, 255, 0.15) !important;
            font-weight: 500 !important;
        }

        body.theme-impostor select {
            -webkit-appearance: none !important;
            -moz-appearance: none !important;
            appearance: none !important;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e6e6ea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e") !important;
            background-repeat: no-repeat !important;
            background-position: right 12px center !important;
            background-size: 16px !important;
        }

        body.theme-impostor select option {
            background: rgba(26, 26, 26, 0.95) !important;
            color: #e6e6ea !important;
            padding: 12px !important;
            font-weight: 500 !important;
        }

        body.theme-impostor input:focus,
        body.theme-impostor select:focus {
            border-color: rgba(255, 43, 74, .45) !important;
            box-shadow: 0 0 0 3px rgba(255, 43, 74, .18) !important;
            outline: none !important;
        }

        .btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 12px;
            background: var(--button-primary);
            color: var(--text-primary);
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 12px;
            transition: transform 0.2s, box-shadow 0.2s;
            min-height: 56px;
            box-shadow: var(--shadow-light);
            position: relative;
            overflow: hidden;
        }

        /* Override para botones en tema impostor */
        body.theme-impostor .btn {
            background: linear-gradient(180deg, #ff2b4a, #ff0033) !important;
            color: #fff !important;
            font-weight: 700 !important;
            letter-spacing: .2px !important;
            box-shadow: 0 0 24px rgba(255, 43, 74, .35), 0 0 2px rgba(255, 43, 74, .8) !important;
        }

        body.theme-impostor .btn:hover {
            transform: translateY(-1px) !important;
            filter: brightness(1.05) !important;
        }

        body.theme-impostor .btn.btn-secondary {
            background: linear-gradient(180deg, #2a2a36, #1c1c25) !important;
            box-shadow: 0 6px 18px rgba(0, 0, 0, .4) !important;
            border: 1px solid rgba(255, 255, 255, 0.08) !important;
        }

        .btn:focus-visible {
            outline: 3px solid var(--accent-color);
            outline-offset: 2px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--button-secondary);
        }

        .player-list {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .word-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 40px 30px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .word {
            font-size: 2.5em;
            font-weight: bold;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin: 10px 0;
        }

        /* Nombre del jugador actual */
        #current-player-name {
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--accent-color);
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .hint {
            font-style: italic;
            color: #ffeb3b;
            margin-top: 15px;
        }

        .impostor-hint {
            background: rgba(255, 193, 7, 0.2);
            border-left: 4px solid #ffeb3b;
            padding: 15px;
            margin-top: 15px;
            border-radius: 0 10px 10px 0;
        }

        .score-board {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .voting-section {
            margin-top: 20px;
        }

        .vote-buttons {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin: 30px 0 50px 0;
            padding: 0;
            width: 100%;
        }

        .vote-btn {
            width: 100%;
            padding: 25px 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 18px;
            font-weight: 700;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            word-wrap: break-word;
            hyphens: auto;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            box-sizing: border-box;
        }

        .vote-btn:hover {
            background: rgba(255, 255, 255, 0.35);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .vote-btn:active {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        }

        .vote-btn.selected {
            background: rgba(255, 235, 59, 0.3);
            border-color: rgba(255, 235, 59, 0.8);
            box-shadow: 0 0 20px rgba(255, 235, 59, 0.4), 0 8px 25px rgba(0, 0, 0, 0.3);
            transform: translateY(-2px);
        }

        .timer {
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 20px;
            color: var(--accent-color);
        }

        .reveal-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: var(--accent-color);
            width: 0%;
            transition: width 0.1s linear;
            border-radius: 0 0 12px 12px;
        }

        .instruction-text {
            text-align: center;
            font-size: 14px;
            opacity: 0.8;
            margin-top: 10px;
        }

        .vote-summary-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 16px;
            background: var(--card-bg);
            margin: 8px 0;
            border-radius: 10px;
            font-weight: 500;
        }

        /* Mejoras específicas para la pantalla de votación */
        #voting-screen {
            padding: 0;
        }

        #voting-info {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        #voting-info p {
            margin: 10px 0;
            font-size: 18px;
            font-weight: 600;
            line-height: 1.4;
        }

        #current-voter {
            font-weight: 800;
            color: var(--accent-color);
            font-size: 1.2em;
            text-shadow: 0 2px 8px rgba(255, 235, 59, 0.3);
        }

        #vote-summary {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 25px 0;
        }

        #vote-summary h3 {
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.3em;
        }

        .word-card {
            background: var(--card-bg-solid);
            color: var(--text-secondary);
        }

        .impostor-hint {
            background: rgba(255, 193, 7, 0.3);
            border-left: 4px solid var(--accent-color);
            color: var(--text-primary);
        }

        /* ========== PALETA Y TOKENS (tema Impostor) ========== */
        .theme-impostor {
            --bg0: #0b0b0f;
            /* negro profundo */
            --bg1: #121218;
            /* negro elevación */
            --bg2: #181820;
            /* negro tarjetas */
            --txt: #e6e6ea;
            /* texto principal */
            --muted: #a1a1b3;
            /* texto secundario */
            --red: #ff2b4a;
            /* rojo neón principal */
            --red-strong: #ff0033;
            /* rojo intenso */
            --accent: #ff7a90;
            /* brillo/acento suave */
            --glow: 0 0 24px rgba(255, 43, 74, .35), 0 0 2px rgba(255, 43, 74, .8);
            --radius-xl: 20px;
            --radius-lg: 14px;
            --radius-md: 10px;
            --border: 1px solid rgba(255, 255, 255, 0.06);
        }

        /* ====== FONDO Y CONTENEDOR ====== */
        .theme-impostor body {
            background: radial-gradient(1200px 600px at 70% -20%, rgba(255, 43, 74, .18), transparent 60%),
                radial-gradient(900px 600px at -10% 110%, rgba(255, 122, 144, .12), transparent 60%),
                linear-gradient(180deg, #0b0b0f 0%, #0a0a0d 100%);
            color: var(--txt);
        }

        .theme-impostor .container {
            width: 92%;
            max-width: 420px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0.02));
            border-radius: var(--radius-xl);
            border: var(--border);
            box-shadow: 0 10px 40px rgba(0, 0, 0, .6);
            position: relative;
            overflow: hidden;
        }

        /* Sutil textura de ruido */
        .theme-impostor .container::before {
            content: "";
            position: absolute;
            inset: 0;
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' opacity='0.05' width='160' height='160' viewBox='0 0 100 100'><filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='2'/></filter><rect width='100' height='100' filter='url(%23n)'/></svg>");
            pointer-events: none;
        }

        /* Borde dinámico de neón (animado) */
        .theme-impostor .container::after {
            content: "";
            position: absolute;
            inset: -2px;
            border-radius: calc(var(--radius-xl) + 2px);
            background: conic-gradient(from 0deg, transparent 0 55%, rgba(255, 43, 74, .35) 60% 65%, transparent 70% 100%);
            mask:
                linear-gradient(#000 0 0) content-box,
                linear-gradient(#000 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            padding: 2px;
            animation: sweep 6s linear infinite;
            pointer-events: none;
        }

        @keyframes sweep {
            to {
                transform: rotate(1turn);
            }
        }

        /* ====== TITULOS ====== */
        .theme-impostor h1,
        .theme-impostor h2 {
            color: #fff;
            text-align: center;
            letter-spacing: 0.5px;
        }

        .theme-impostor h1 {
            font-size: 2.3rem;
            text-shadow: 0 0 12px rgba(255, 43, 74, .35);
        }

        /* ====== TARJETAS Y SECCIONES ====== */
        .theme-impostor .game-description,
        .theme-impostor .word-card,
        .theme-impostor .score-board,
        .theme-impostor .player-list {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0.02));
            border: var(--border);
            border-radius: var(--radius-lg);
            box-shadow: 0 6px 24px rgba(0, 0, 0, .35);
        }

        /* Tarjetas de roles más grandes en tema impostor */
        .theme-impostor .word-card {
            padding: 50px 35px;
            min-height: 250px;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, .5);
        }

        .theme-impostor .word {
            font-size: 2.8em;
            margin: 15px 0;
        }

        .theme-impostor #current-player-name {
            font-size: 2.2em;
            color: var(--accent);
            text-shadow: 0 0 15px rgba(255, 122, 144, .4);
            margin-bottom: 30px;
        }

        /* Variante impostor y victoria/derrota */
        .theme-impostor .word-card.impostor {
            background: linear-gradient(180deg, rgba(255, 0, 51, 0.1), rgba(255, 0, 51, 0.05));
            border-color: rgba(255, 43, 74, .35);
            box-shadow: var(--glow);
        }

        .theme-impostor .word-card.success {
            background: linear-gradient(180deg, rgba(0, 200, 120, 0.12), rgba(0, 200, 120, 0.06));
            border-color: rgba(0, 200, 120, .35);
        }

        .theme-impostor .word-card.fail {
            background: linear-gradient(180deg, rgba(255, 80, 80, 0.12), rgba(255, 80, 80, 0.06));
            border-color: rgba(255, 80, 80, .35);
        }

        /* ====== TIPOGRAFIA Y TEXTOS ====== */
        .theme-impostor .hint {
            color: var(--accent);
        }

        .theme-impostor label {
            color: var(--muted);
        }

        /* ====== INPUTS ====== */
        .theme-impostor input,
        .theme-impostor select {
            background: rgba(255, 255, 255, 0.06);
            color: var(--txt);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: var(--radius-md);
            outline: none;
        }

        .theme-impostor input:focus,
        .theme-impostor select:focus {
            border-color: rgba(255, 43, 74, .45);
            box-shadow: 0 0 0 3px rgba(255, 43, 74, .18);
        }

        /* ====== BOTONES ====== */
        .theme-impostor .btn {
            background: linear-gradient(180deg, #ff2b4a, #ff0033);
            color: #fff;
            border-radius: var(--radius-md);
            border: none;
            font-weight: 700;
            letter-spacing: .2px;
            box-shadow: var(--glow);
            transition: transform .15s ease, box-shadow .2s ease, filter .2s ease;
        }

        .theme-impostor .btn:hover {
            transform: translateY(-1px);
            filter: brightness(1.05);
        }

        .theme-impostor .btn:active {
            transform: translateY(0);
            filter: brightness(.98);
        }

        .theme-impostor .btn.btn-secondary {
            background: linear-gradient(180deg, #2a2a36, #1c1c25);
            box-shadow: 0 6px 18px rgba(0, 0, 0, .4);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        /* Botones de voto con borde animado */
        .theme-impostor .vote-btn {
            width: 100%;
            background: rgba(255, 255, 255, 0.06);
            border: 2px solid rgba(255, 255, 255, 0.15);
            color: #fff;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            font-size: 18px;
            font-weight: 700;
            padding: 25px 20px;
            min-height: 90px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            word-wrap: break-word;
            hyphens: auto;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-impostor .vote-btn::after {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(650px 80px at var(--x, 50%) 120%, rgba(255, 43, 74, .22), transparent 60%);
            transition: 0.2s;
            pointer-events: none;
        }

        .theme-impostor .vote-btn:hover {
            border-color: rgba(255, 43, 74, .6);
            background: rgba(255, 255, 255, 0.1);
            box-shadow: var(--glow), 0 10px 35px rgba(0, 0, 0, 0.6);
            transform: translateY(-4px);
        }

        .theme-impostor .vote-btn:active {
            transform: translateY(-2px);
            box-shadow: var(--glow), 0 8px 25px rgba(0, 0, 0, 0.5);
        }

        .theme-impostor .vote-btn.selected {
            background: rgba(255, 0, 51, .25);
            border-color: rgba(255, 0, 51, .8);
            box-shadow: var(--glow), 0 0 30px rgba(255, 43, 74, .6), 0 10px 35px rgba(0, 0, 0, 0.6);
            transform: translateY(-3px);
        }

        /* ====== TIMER ====== */
        .theme-impostor .timer {
            color: #fff;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(255, 43, 74, .35);
        }

        .theme-impostor .timer.low {
            color: var(--red);
        }

        /* ====== TEMAS (checkboxes) ====== */
        .theme-impostor .theme-item {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .theme-impostor .theme-item input[type="checkbox"] {
            accent-color: var(--red);
        }

        /* ====== ACCESIBILIDAD Y REDUCIR MOVIMIENTO ====== */
        @media (prefers-reduced-motion: reduce) {
            .theme-impostor .container::after {
                animation: none;
            }

            .theme-impostor .btn,
            .theme-impostor .vote-btn {
                transition: none;
            }
        }

        /* ====== VOTACIÓN EN TEMA IMPOSTOR ====== */
        .theme-impostor #voting-info {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.03));
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 6px 24px rgba(0, 0, 0, .35);
        }

        .theme-impostor #current-voter {
            color: var(--accent);
            text-shadow: 0 0 8px rgba(255, 122, 144, .4);
        }

        .theme-impostor #vote-summary {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.03));
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 6px 24px rgba(0, 0, 0, .35);
        }

        .theme-impostor .vote-summary-item {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.06);
            color: #e6e6ea;
        }

        /* ====== RESPONSIVE FINO ====== */
        @media (max-width: 480px) {
            .theme-impostor h1 {
                font-size: 2rem;
            }

            .theme-impostor .container {
                padding: 22px;
            }

            .vote-buttons {
                display: flex;
                flex-direction: column;
                gap: 22px;
                margin: 25px 0 40px 0;
                width: 100%;
            }

            .vote-btn {
                width: 100%;
                min-height: 80px;
                padding: 22px 18px;
                font-size: 17px;
                font-weight: 700;
                box-sizing: border-box;
            }

            .theme-impostor .vote-btn {
                width: 100%;
                min-height: 80px;
                padding: 22px 18px;
                font-size: 17px;
                box-sizing: border-box;
            }

            .theme-impostor .word-card {
                padding: 35px 25px;
                min-height: 200px;
            }

            .theme-impostor .word {
                font-size: 2.3em;
            }

            .theme-impostor #current-player-name {
                font-size: 1.8em;
                margin-bottom: 20px;
            }
        }

        .themes-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .theme-item {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px;
            border-radius: 8px;
        }

        /* Override para theme-items en tema impostor */
        body.theme-impostor .theme-item {
            background: rgba(255, 255, 255, 0.04) !important;
            border: 1px solid rgba(255, 255, 255, 0.08) !important;
        }

        body        .theme-impostor .theme-item input[type="checkbox"] {
            accent-color: #ff2b4a !important;
        }

        /* ====== BOTÓN DE INSTALACIÓN PWA ====== */
        #install-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049) !important;
            color: white !important;
            font-weight: 800 !important;
            border: none !important;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4) !important;
            position: relative !important;
            overflow: hidden !important;
        }

        #install-btn:hover {
            background: linear-gradient(45deg, #45a049, #3d8b40) !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.5) !important;
        }

        #install-btn:active {
            transform: translateY(0) !important;
        }

        /* Tema impostor para botón de instalación */
        .theme-impostor #install-btn {
            background: linear-gradient(45deg, #00C851, #007E33) !important;
            box-shadow: 0 0 20px rgba(0, 200, 81, 0.4), 0 6px 20px rgba(0, 0, 0, 0.3) !important;
        }

        .theme-impostor #install-btn:hover {
            background: linear-gradient(45deg, #007E33, #00C851) !important;
            box-shadow: 0 0 25px rgba(0, 200, 81, 0.6), 0 8px 25px rgba(0, 0, 0, 0.4) !important;
        }

        .theme-item input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
            transform: scale(1.2);
        }

        .theme-item label {
            margin: 0;
            font-size: 14px;
            cursor: pointer;
        }

        /* Estilos para pantalla de palabras personalizadas */
        #custom-words-list {
            margin-top: 25px;
        }

        #custom-words-list h3 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .custom-word-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
        }

        .custom-word-info {
            flex: 1;
            min-width: 200px;
        }

        .custom-word-info strong {
            display: block;
            font-size: 16px;
            margin-bottom: 5px;
            color: var(--accent-color);
        }

        .custom-word-info small {
            display: block;
            opacity: 0.8;
            margin: 2px 0;
        }

        .custom-word-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            min-height: auto;
            width: auto;
        }

        .btn-danger {
            background: linear-gradient(45deg, #ff4757, #ff3838);
        }

        /* Override para tema impostor en palabras personalizadas */
        .theme-impostor .custom-word-item {
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .theme-impostor .custom-word-info strong {
            color: var(--accent);
        }

        /* Estilos para la pantalla de instrucciones */
        #how-to-play-screen .game-description {
            margin-bottom: 25px;
        }

        #how-to-play-screen h3 {
            color: var(--accent-color);
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(255, 235, 59, 0.3);
            padding-bottom: 8px;
        }

        #how-to-play-screen p {
            margin: 8px 0;
            line-height: 1.6;
        }

        #how-to-play-screen strong {
            color: #fff;
            font-weight: 700;
        }

        #how-to-play-screen em {
            color: var(--accent-color);
            font-style: italic;
            font-weight: 500;
        }

        /* Override para tema impostor en instrucciones */
        .theme-impostor #how-to-play-screen h3 {
            color: var(--accent);
            border-bottom-color: rgba(255, 122, 144, 0.3);
        }

        .theme-impostor #how-to-play-screen em {
            color: var(--accent);
        }

        /* Responsive para tablets */
        @media (max-width: 768px) and (min-width: 481px) {
            .vote-buttons {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
                width: 100%;
            }

            .vote-btn {
                width: 100%;
                min-height: 85px;
                padding: 24px 18px;
                font-size: 17px;
                box-sizing: border-box;
            }

            .theme-impostor .vote-btn {
                width: 100%;
                min-height: 85px;
                padding: 24px 18px;
                font-size: 17px;
                box-sizing: border-box;
            }
        }

        @media (max-width: 480px) {
            .container {
                width: 95%;
                padding: 20px;
            }

            h1 {
                font-size: 2em;
            }

            .themes-grid {
                grid-template-columns: 1fr;
            }

            .custom-word-item {
                flex-direction: column;
            }

            .custom-word-actions {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body class="theme-impostor">
    <div class="container">
        <!-- Pantalla de Inicio -->
        <div id="home-screen" class="screen active">
            <h1>🕵️ IMPOSTOR</h1>
            <div class="game-description" id="game-instructions">
                <div class="instructions-header">
                    <h3>¿Cómo se juega?</h3>
                    <button class="close-instructions" onclick="hideInstructions()"
                        title="Cerrar instrucciones">✕</button>
                </div>
                <p>• Uno o más jugadores serán <strong>impostores</strong></p>
                <p>• Los demás conocen la <strong>palabra secreta</strong></p>
                <p>• Hagan preguntas para descubrir quién es el impostor</p>
                <p>• Los impostores reciben pistas para pasar desapercibidos</p>
                <p>• ¡Voten al final para eliminar a los sospechosos!</p>
            </div>

            <div class="input-group">
                <label for="player-count">Número de jugadores (3-10):</label>
                <input type="number" id="player-count" min="3" max="10" value="4">
            </div>

            <div class="input-group">
                <label for="impostor-count">Número de impostores:</label>
                <select id="impostor-count">
                    <option value="1">1 impostor</option>
                    <option value="2">2 impostores</option>
                </select>
            </div>

            <div class="input-group">
                <label for="game-time">⏰ Tiempo de discusión:</label>
                <select id="game-time">
                    <option value="180">3 minutos</option>
                    <option value="300" selected>5 minutos</option>
                    <option value="420">7 minutos</option>
                    <option value="600">10 minutos</option>
                    <option value="900">15 minutos</option>
                    <option value="0">Sin límite</option>
                </select>
            </div>

            <div class="input-group">
                <label for="difficulty">🎯 Dificultad de las pistas:</label>
                <select id="difficulty">
                    <option value="easy">🟢 Fácil - Pistas claras</option>
                    <option value="hard" selected>🔴 Difícil - Pistas genéricas</option>
                    <option value="impossible">⚫ Imposible - Solo categoría</option>
                </select>
            </div>

            <div class="input-group">
                <label>🎯 Temáticas del juego:</label>
                <div class="themes-grid">
                    <div class="theme-item">
                        <input type="checkbox" id="comida_argentina" checked>
                        <label for="comida_argentina">🥩 Comida Argentina</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="bebidas_argentinas" checked>
                        <label for="bebidas_argentinas">🧉 Bebidas</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="futbol_argentino" checked>
                        <label for="futbol_argentino">⚽ Fútbol</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="lugares_argentina" checked>
                        <label for="lugares_argentina">🏔️ Lugares</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="cordobes" checked>
                        <label for="cordobes">🏙️ Córdoba</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="tango_folklore" checked>
                        <label for="tango_folklore">🎶 Tango/Folklore</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="politica_historia">
                        <label for="politica_historia">🏛️ Historia</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="transporte">
                        <label for="transporte">🚌 Transporte</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="animales_pampa">
                        <label for="animales_pampa">🐾 Animales</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="lunfardo_jerga">
                        <label for="lunfardo_jerga">🗣️ Lunfardo</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="futbolistas">
                        <label for="futbolistas">⚽ Futbolistas</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="peleadores">
                        <label for="peleadores">🥊 Peleadores</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="musica">
                        <label for="musica">🎵 Música</label>
                    </div>
                    <div class="theme-item">
                        <input type="checkbox" id="libre_amigos">
                        <label for="libre_amigos">👥 Libre Amigos</label>
                    </div>
                    <div class="theme-item private-theme" style="display: none;">
                        <input type="checkbox" id="categoria_privada">
                        <label for="categoria_privada">🔒 Privada +18</label>
                    </div>
                </div>
                <div class="private-access" style="margin-top: 15px;">
                    <button type="button" class="btn btn-secondary" onclick="togglePrivateCategory()"
                        id="private-btn">🔒 Desbloquear Categoría Privada</button>
                </div>
            </div>

            <button class="btn" onclick="setupPlayers()">Configurar Jugadores</button>
            <button class="btn btn-secondary" onclick="showHowToPlay()">📖 Cómo Jugar</button>
            <button class="btn btn-secondary" onclick="showCustomWords()" id="custom-words-btn"
                style="display: none;">✏️ Gestionar Palabras Personalizadas</button>
            <button class="btn" onclick="installGame()" id="install-btn" style="display: none;">
                📱 Descargar Juego
            </button>
        </div>

        <!-- Pantalla de Palabras Personalizadas -->
        <div id="custom-words-screen" class="screen">
            <h2>👥 Palabras Personalizadas</h2>
            <div class="game-description">
                <p>Crea tus propias palabras para jugar con amigos</p>
                <p>• Ingresa una palabra y sus pistas</p>
                <p>• Puedes usar nombres, lugares, referencias internas</p>
                <p>• ¡Agrega tantas palabras como quieras!</p>
            </div>

            <div class="input-group">
                <label for="custom-word">Palabra:</label>
                <input type="text" id="custom-word" placeholder="Ej: NOMBRE DEL AMIGO" maxlength="30">
            </div>

            <div class="input-group">
                <label for="custom-easy-hint">Pista Fácil:</label>
                <input type="text" id="custom-easy-hint" placeholder="Pista obvia" maxlength="50">
            </div>

            <div class="input-group">
                <label for="custom-hard-hint">Pista Difícil:</label>
                <input type="text" id="custom-hard-hint" placeholder="Pista genérica" maxlength="50">
            </div>

            <button class="btn" onclick="addCustomWord()">➕ Agregar Palabra</button>

            <div id="custom-words-list">
                <h3>Palabras Agregadas:</h3>
                <div id="custom-words-container"></div>
            </div>

            <button class="btn btn-secondary" onclick="goHome()">Volver</button>
        </div>

        <!-- Pantalla de Cómo Jugar -->
        <div id="how-to-play-screen" class="screen">
            <h2>📖 Cómo Jugar</h2>

            <div class="game-description">
                <h3>🎯 Objetivo del Juego</h3>
                <p>Los <strong>detectives</strong> deben descubrir quién es el <strong>impostor</strong> antes de que
                    termine el tiempo.</p>
                <p>El <strong>impostor</strong> debe pasar desapercibido y no ser descubierto.</p>
            </div>

            <div class="game-description">
                <h3>🏆 Sistema de Puntuación</h3>
                <p>• <strong>Si el impostor NO es descubierto:</strong> El impostor gana <span
                        style="color: #ffeb3b;">15 puntos</span></p>
                <p>• <strong>Si el impostor ES descubierto:</strong> Los detectives ganan <span
                        style="color: #ffeb3b;">10 puntos</span></p>
                <p>• <strong>Eliminación:</strong> Se juega una sola ronda por cada impostor que existe</p>
            </div>

            <div class="game-description">
                <h3>🎮 Modalidad 1: Palabra por Turno</h3>
                <p><strong>Más difícil para el impostor</strong></p>
                <p>• Cada jugador dice <strong>una palabra</strong> relacionada con la palabra secreta</p>
                <p>• Se pueden hacer <strong>varias rondas</strong> de palabras</p>
                <p>• Al final se vota quién es el impostor</p>
                <p>• <em>Ideal para pocos jugadores (3-5)</em></p>
            </div>

            <div class="game-description">
                <h3>🎮 Modalidad 2: Preguntas Genéricas</h3>
                <p><strong>Modalidad más divertida y equilibrada</strong></p>
                <p>• Se hacen <strong>preguntas genéricas</strong> que no mencionen la palabra directamente</p>
                <p>• Ejemplos: "¿Con qué color lo identificas?", "¿Te gustaría conocerlo?", "¿Es grande o pequeño?"</p>
                <p>• Todos responden por turnos</p>
                <p>• <strong>Preguntas y respuestas cruzadas</strong> para crear confusión</p>
                <p>• <em>La modalidad que más posibilidades da al impostor</em></p>
            </div>

            <div class="game-description">
                <h3>🎮 Modalidad 3: Preguntas Abiertas</h3>
                <p><strong>Modalidad libre y espontánea</strong></p>
                <p>• Se hacen <strong>preguntas generales</strong> sobre la palabra</p>
                <p>• <strong>Respuesta libre:</strong> Quien quiera puede contestar</p>
                <p>• Permite más interacción y conversación</p>
                <p>• <em>Ideal para grupos grandes y dinámicos</em></p>
            </div>

            <div class="game-description">
                <h3>💡 Consejos para Impostores</h3>
                <p>• <strong>Observa</strong> las respuestas de otros antes de hablar</p>
                <p>• <strong>Copia el estilo</strong> de respuestas de los demás</p>
                <p>• <strong>Sé genérico</strong> pero no demasiado obvio</p>
                <p>• <strong>Usa las pistas</strong> que recibes para guiarte</p>
                <p>• <strong>Mantén la calma</strong> y actúa natural</p>
            </div>

            <div class="game-description">
                <h3>🔍 Consejos para Detectives</h3>
                <p>• <strong>Escucha atentamente</strong> las respuestas de todos</p>
                <p>• <strong>Busca inconsistencias</strong> en las respuestas</p>
                <p>• <strong>Haz preguntas estratégicas</strong> que revelen conocimiento</p>
                <p>• <strong>Observa el lenguaje corporal</strong> y dudas</p>
                <p>• <strong>No votes al azar</strong>, discutan antes de decidir</p>
            </div>

            <button class="btn btn-secondary" onclick="goHome()">Volver al Menú</button>
        </div>

        <!-- Pantalla de Configuración de Jugadores -->
        <div id="players-screen" class="screen">
            <h2>Jugadores</h2>
            <div id="player-inputs"></div>
            <button class="btn" onclick="startGame()">Comenzar Juego</button>
            <button class="btn btn-secondary" onclick="goHome()">Volver</button>
        </div>

        <!-- Pantalla de Roles -->
        <div id="roles-screen" class="screen">
            <h2>Descubre tu Rol</h2>
            <p>Pasa el dispositivo a cada jugador para que vea su rol secreto.</p>
            <div id="current-player-info">
                <h3 id="current-player-name" aria-live="polite"></h3>
                <button class="btn" id="reveal-btn" role="button" aria-label="Mantén pulsado para ver tu rol">
                    <span id="reveal-text">Mantén Pulsado para Ver Rol</span>
                    <div id="reveal-progress" class="reveal-progress"></div>
                </button>
                <p class="instruction-text">👆 Mantén pulsado 0.5 segundos</p>
            </div>
            <div id="role-display" style="display: none;">
                <div class="word-card" id="role-card" aria-live="assertive"></div>
                <button class="btn" onclick="nextPlayer()">Siguiente Jugador</button>
            </div>
        </div>

        <!-- Pantalla de Juego -->
        <div id="game-screen" class="screen">
            <h2>¡A Jugar!</h2>
            <div class="timer" id="game-timer">Tiempo: 5:00</div>

            <div class="game-description">
                <p><strong>Instrucciones:</strong></p>
                <p>• Hagan preguntas relacionadas con la palabra</p>
                <p>• Los impostores deben intentar pasar desapercibidos</p>
                <p>• Observen las respuestas sospechosas</p>
            </div>

            <button class="btn" onclick="startVoting()">Comenzar Votación</button>
            <button class="btn btn-secondary" onclick="showHints()">Ver Pistas (Solo Impostores)</button>
            <button class="btn btn-secondary" onclick="addMoreTime()" id="add-time-btn" style="display: none;">⏰ +2
                min</button>
        </div>

        <!-- Pantalla de Pistas -->
        <div id="hints-screen" class="screen">
            <h2>Pistas para Impostores</h2>
            <div class="impostor-hint" id="hint-content"></div>
            <button class="btn" onclick="backToGame()">Volver al Juego</button>
        </div>

        <!-- Pantalla de Votación -->
        <div id="voting-screen" class="screen">
            <h2>¡Hora de Votar!</h2>
            <div id="voting-info">
                <p>Votando: <span id="current-voter" aria-live="polite"></span></p>
                <p>¿Quién crees que es el impostor?</p>
            </div>
            <div class="vote-buttons" id="vote-buttons"></div>
            <div id="vote-summary" style="display: none;">
                <h3>Resumen de Votos:</h3>
                <div id="vote-counts"></div>
            </div>
            <button class="btn" onclick="processVote()" id="vote-btn">Confirmar Voto</button>
            <button class="btn btn-secondary" onclick="showVoteSummary()" id="summary-btn" style="display: none;">Ver
                Resultados</button>
        </div>

        <!-- Pantalla de Resultados -->
        <div id="results-screen" class="screen">
            <h2>Resultados</h2>
            <div id="results-content"></div>
            <div class="score-board" id="score-board"></div>
            <button class="btn" onclick="playAgain()">Jugar de Nuevo</button>
            <button class="btn btn-secondary" onclick="goHome()">Menú Principal</button>
        </div>
    </div>

    <script>
        // Variables para PWA
        let deferredPrompt;
        let installButton = null;

        // Variables del juego
        let gameState = {
            players: [],
            impostors: [],
            currentPlayerIndex: 0,
            currentVoterIndex: 0,
            votes: {}, // {votante: candidato}
            votesCount: {}, // {candidato: cantidad}
            scores: {},
            currentWord: '',
            gameTimer: null,
            timeLeft: 300, // 5 minutos
            selectedVote: null
        };

        // Sistema de localStorage
        function saveGameData() {
            const dataToSave = {
                players: gameState.players,
                scores: gameState.scores,
                activeThemes: activeThemes,
                privateUnlocked: privateUnlocked,
                difficulty: document.getElementById('difficulty').value,
                customWords: wordsByTheme.libre_amigos
            };
            localStorage.setItem('impostorGameData', JSON.stringify(dataToSave));
        }

        function loadGameData() {
            const savedData = localStorage.getItem('impostorGameData');
            if (savedData) {
                const data = JSON.parse(savedData);
                if (data.players && data.players.length > 0) {
                    // Cargar jugadores guardados
                    gameState.scores = data.scores || {};
                }
                if (data.activeThemes) {
                    Object.assign(activeThemes, data.activeThemes);
                    updateThemeCheckboxes();
                }
                if (data.privateUnlocked) {
                    privateUnlocked = data.privateUnlocked;
                    if (privateUnlocked) {
                        document.querySelector('.private-theme').style.display = 'flex';
                        document.getElementById('private-btn').textContent = '🔓 Ocultar Categoría Privada';
                    }
                }
                if (data.difficulty) {
                    const difficultySelect = document.getElementById('difficulty');
                    // Verificar que la dificultad guardada sea válida
                    const validDifficulties = ['easy', 'hard', 'impossible'];
                    if (validDifficulties.includes(data.difficulty)) {
                        difficultySelect.value = data.difficulty;
                    }
                }
                if (data.customWords) {
                    wordsByTheme.libre_amigos = data.customWords;
                }
            }
        }

        function updateThemeCheckboxes() {
            Object.keys(activeThemes).forEach(theme => {
                const checkbox = document.getElementById(theme);
                if (checkbox) {
                    checkbox.checked = activeThemes[theme];
                }
            });
        }

        // Palabras organizadas por temáticas argentinas/cordobesas con pistas fáciles y difíciles
        const wordsByTheme = {
            "comida_argentina": [
                { word: "ASADO", easyHint: "Fuego", hardHint: "Domingo" },
                { word: "EMPANADA", easyHint: "Masa", hardHint: "Tucumán" },
                { word: "MILANESA", easyHint: "Rebozado", hardHint: "Italiana" },
                { word: "CHORIPAN", easyHint: "Sandwich", hardHint: "Cancha" },
                { word: "LOCRO", easyHint: "Guiso", hardHint: "Mayo" },
                { word: "MATAMBRE", easyHint: "Relleno", hardHint: "Enrollado" },
                { word: "HUMITA", easyHint: "Choclo", hardHint: "Amarillo" },
                { word: "PROVOLETA", easyHint: "Parrilla", hardHint: "Derretido" },
                { word: "BONDIOLA", easyHint: "Cerdo", hardHint: "Ahumado" },
                { word: "MORCILLA", easyHint: "Negro", hardHint: "Sangre" },
                { word: "CHINCHULÍN", easyHint: "Tripa", hardHint: "Crocante" },
                { word: "MOLLEJA", easyHint: "Glándula", hardHint: "Tierna" },
                { word: "ALFAJOR", easyHint: "Dulce", hardHint: "Havanna" },
                { word: "FACTURAS", easyHint: "Panadería", hardHint: "Domingo" },
                { word: "MEDIALUNAS", easyHint: "Cuerno", hardHint: "Manteca" }
            ],
            "bebidas_argentinas": [
                { word: "MATE", easyHint: "Calabaza", hardHint: "Compartir" },
                { word: "FERNET", easyHint: "Amargo", hardHint: "Córdoba" },
                { word: "QUILMES", easyHint: "Dorada", hardHint: "Nacional" },
                { word: "MALBEC", easyHint: "Tinto", hardHint: "Mendoza" },
                { word: "TORRONTÉS", easyHint: "Blanco", hardHint: "Aromático" },
                { word: "GANCIA", easyHint: "Aperitivo", hardHint: "Batido" },
                { word: "CAMPARI", easyHint: "Rojo", hardHint: "Italiano" },
                { word: "LICUADO", easyHint: "Batido", hardHint: "Fruta" },
                { word: "SUBMARINO", easyHint: "Chocolate", hardHint: "Caliente" },
                { word: "CORTADO", easyHint: "Café", hardHint: "Pequeño" },
                { word: "LAGRIMA", easyHint: "Leche", hardHint: "Gotita" },
                { word: "GINEBRA", easyHint: "Destilado", hardHint: "Transparente" },
                { word: "HESPERIDINA", easyHint: "Naranja", hardHint: "Amargo" },
                { word: "APEROL", easyHint: "Italiano", hardHint: "Spritz" },
                { word: "TERMA", easyHint: "Caliente", hardHint: "Recipiente" }
            ],
            "futbol_argentino": [
                { word: "BOCA", easyHint: "Azul", hardHint: "Xeneize" },
                { word: "RIVER", easyHint: "Banda", hardHint: "Millonario" },
                { word: "MARADONA", easyHint: "Diez", hardHint: "Dios" },
                { word: "MESSI", easyHint: "Pulga", hardHint: "Rosario" },
                { word: "BOMBONERA", easyHint: "Estadio", hardHint: "Chocolate" },
                { word: "MONUMENTAL", easyHint: "Núñez", hardHint: "Grande" },
                { word: "SUPERCLÁSICO", easyHint: "Rivalidad", hardHint: "Partido" },
                { word: "ESTUDIANTES", easyHint: "Pincha", hardHint: "Plata" },
                { word: "RACING", easyHint: "Academia", hardHint: "Avellaneda" },
                { word: "INDEPENDIENTE", easyHint: "Rojo", hardHint: "Rey" },
                { word: "HURACÁN", easyHint: "Globo", hardHint: "Parque" },
                { word: "LANÚS", easyHint: "Granate", hardHint: "Fortaleza" },
                { word: "TALLERES", easyHint: "Córdoba", hardHint: "Matador" },
                { word: "BELGRANO", easyHint: "Celeste", hardHint: "Pirata" },
                { word: "INSTITUTO", easyHint: "Gloria", hardHint: "Alberdi" }
            ],
            "lugares_argentina": [
                { word: "CAMINITO", easyHint: "Colorido", hardHint: "Boca" },
                { word: "IGUAZÚ", easyHint: "Cataratas", hardHint: "Frontera" },
                { word: "MENDOZA", easyHint: "Vino", hardHint: "Cuyo" },
                { word: "BARILOCHE", easyHint: "Lagos", hardHint: "Chocolate" },
                { word: "SALTA", easyHint: "Norte", hardHint: "Linda" },
                { word: "USHUAIA", easyHint: "Fin", hardHint: "Mundo" },
                { word: "TIGRE", easyHint: "Delta", hardHint: "Río" },
                { word: "ROSARIO", easyHint: "Bandera", hardHint: "Cuna" },
                { word: "CALAFATE", easyHint: "Glaciar", hardHint: "Perito" },
                { word: "CAFAYATE", easyHint: "Valles", hardHint: "Torrontés" },
                { word: "TILCARA", easyHint: "Quebrada", hardHint: "Humahuaca" },
                { word: "PENÍNSULA", easyHint: "Valdés", hardHint: "Ballenas" },
                { word: "ACONCAGUA", easyHint: "Cumbre", hardHint: "América" },
                { word: "OBELISCO", easyHint: "Monumento", hardHint: "Avenida" },
                { word: "RECOLETA", easyHint: "Cementerio", hardHint: "Evita" }
            ],
            "cordobes": [
                { word: "CUARTETO", easyHint: "Ritmo", hardHint: "Baile" },
                { word: "MONA", easyHint: "Jiménez", hardHint: "Mandril" },
                { word: "FERNET", easyHint: "Cola", hardHint: "Branca" },
                { word: "SIERRAS", easyHint: "Montañas", hardHint: "Punilla" },
                { word: "DOCTA", easyHint: "Universidad", hardHint: "Córdoba" },
                { word: "PEÑA", easyHint: "Folklore", hardHint: "Jesús" },
                { word: "CHAMUYAR", easyHint: "Conversar", hardHint: "Hablar" },
                { word: "CULIAU", easyHint: "Expresión", hardHint: "Cordobés" },
                { word: "BOLUDO", easyHint: "Amigo", hardHint: "Che" },
                { word: "BONDI", easyHint: "Transporte", hardHint: "Público" },
                { word: "BIRRA", easyHint: "Cerveza", hardHint: "Fría" },
                { word: "ASADITO", easyHint: "Reunión", hardHint: "Amigos" },
                { word: "VILLA", easyHint: "Carlos", hardHint: "Paz" },
                { word: "CARLOS", easyHint: "Paz", hardHint: "Villa" },
                { word: "COSQUÍN", easyHint: "Festival", hardHint: "Folklore" }
            ],
            "tango_folklore": [
                { word: "GARDEL", easyHint: "Zorzal", hardHint: "Criollo" },
                { word: "BANDONEÓN", easyHint: "Instrumento", hardHint: "Acordeón" },
                { word: "MILONGA", easyHint: "Baile", hardHint: "Tango" },
                { word: "PIAZZOLLA", easyHint: "Astor", hardHint: "Libertango" },
                { word: "CHACARERA", easyHint: "Folclore", hardHint: "Santiago" },
                { word: "ZAMBA", easyHint: "Pañuelo", hardHint: "Alfonsina" },
                { word: "VIDALA", easyHint: "Canto", hardHint: "Triste" },
                { word: "MALAMBO", easyHint: "Zapateo", hardHint: "Gaucho" },
                { word: "PAYADOR", easyHint: "Improvisación", hardHint: "Guitarra" },
                { word: "GAUCHO", easyHint: "Campo", hardHint: "Pampa" },
                { word: "FACÓN", easyHint: "Cuchillo", hardHint: "Gaucho" },
                { word: "PONCHO", easyHint: "Abrigo", hardHint: "Lana" },
                { word: "ALPARGATAS", easyHint: "Calzado", hardHint: "Cáñamo" },
                { word: "BOMBACHA", easyHint: "Pantalón", hardHint: "Gaucho" },
                { word: "BOINA", easyHint: "Gorro", hardHint: "Vasca" }
            ],
            "politica_historia": [
                { word: "EVITA", easyHint: "Abanderada", hardHint: "Humildes" },
                { word: "PERÓN", easyHint: "General", hardHint: "Justicialismo" },
                { word: "BELGRANO", easyHint: "Bandera", hardHint: "Manuel" },
                { word: "SARMIENTO", easyHint: "Educación", hardHint: "Domingo" },
                { word: "ROCA", easyHint: "Desierto", hardHint: "Conquista" },
                { word: "YRIGOYEN", easyHint: "Radical", hardHint: "Hipólito" },
                { word: "MALVINAS", easyHint: "Islas", hardHint: "Guerra" },
                { word: "MAYO", easyHint: "Revolución", hardHint: "1810" },
                { word: "CABILDO", easyHint: "Colonial", hardHint: "Abierto" },
                { word: "INDEPENDENCIA", easyHint: "Tucumán", hardHint: "1816" },
                { word: "LIBERTADOR", easyHint: "San", hardHint: "Martín" },
                { word: "CRUZADA", easyHint: "Andes", hardHint: "Libertadora" },
                { word: "ROSARIO", easyHint: "Bandera", hardHint: "Cuna" },
                { word: "CONGRESO", easyHint: "Nacional", hardHint: "Diputados" },
                { word: "CASA", easyHint: "Rosada", hardHint: "Gobierno" }
            ],
            "transporte": [
                { word: "SUBTE", easyHint: "Subterráneo", hardHint: "Metro" },
                { word: "COLECTIVO", easyHint: "Urbano", hardHint: "Línea" },
                { word: "REMISE", easyHint: "Radio", hardHint: "Taxi" },
                { word: "TAXI", easyHint: "Amarillo", hardHint: "Bandera" },
                { word: "TREN", easyHint: "Riel", hardHint: "Vagón" },
                { word: "COMBI", easyHint: "Minibús", hardHint: "Escolar" },
                { word: "TROLEBÚS", easyHint: "Eléctrico", hardHint: "Cable" },
                { word: "LANCHA", easyHint: "Río", hardHint: "Tigre" },
                { word: "AVIÓN", easyHint: "Vuelo", hardHint: "Aeropuerto" },
                { word: "MOTO", easyHint: "Delivery", hardHint: "Rappi" },
                { word: "BICICLETA", easyHint: "Pedal", hardHint: "Ecobici" },
                { word: "UBER", easyHint: "App", hardHint: "Viaje" },
                { word: "CABIFY", easyHint: "Aplicación", hardHint: "Premium" },
                { word: "METROBUS", easyHint: "Carril", hardHint: "Exclusivo" },
                { word: "PEAJE", easyHint: "Pago", hardHint: "Autopista" }
            ],
            "animales_pampa": [
                { word: "CARPINCHO", easyHint: "Roedor", hardHint: "Grande" },
                { word: "HORNERO", easyHint: "Nido", hardHint: "Barro" },
                { word: "ÑANDÚ", easyHint: "Corredor", hardHint: "Avestruz" },
                { word: "VIZCACHA", easyHint: "Madriguera", hardHint: "Conejo" },
                { word: "CHIMANGO", easyHint: "Carroñero", hardHint: "Halcón" },
                { word: "BENTEVEO", easyHint: "Canto", hardHint: "Amarillo" },
                { word: "TERO", easyHint: "Grito", hardHint: "Protector" },
                { word: "CARANCHO", easyHint: "Rapaz", hardHint: "Campo" },
                { word: "MARTINETA", easyHint: "Perdiz", hardHint: "Copetona" },
                { word: "MULITA", easyHint: "Armadillo", hardHint: "Peludo" },
                { word: "ZORRINO", easyHint: "Olor", hardHint: "Rayado" },
                { word: "COMADREJA", easyHint: "Pequeña", hardHint: "Carnívora" },
                { word: "LIEBRE", easyHint: "Veloz", hardHint: "Orejas" },
                { word: "YACARÉ", easyHint: "Reptil", hardHint: "Cocodrilo" },
                { word: "DORADO", easyHint: "Pez", hardHint: "Río" }
            ],
            "lunfardo_jerga": [
                { word: "LABURO", easyHint: "Trabajo", hardHint: "Ocupación" },
                { word: "GUITA", easyHint: "Dinero", hardHint: "Plata" },
                { word: "PIBE", easyHint: "Chico", hardHint: "Joven" },
                { word: "MINA", easyHint: "Mujer", hardHint: "Chica" },
                { word: "CHABON", easyHint: "Tipo", hardHint: "Hombre" },
                { word: "MORFAR", easyHint: "Comer", hardHint: "Alimentarse" },
                { word: "FIACA", easyHint: "Pereza", hardHint: "Desgano" },
                { word: "QUILOMBO", easyHint: "Lío", hardHint: "Desorden" },
                { word: "CHAMUYAR", easyHint: "Hablar", hardHint: "Conversar" },
                { word: "BONDI", easyHint: "Colectivo", hardHint: "Transporte" },
                { word: "BIRRA", easyHint: "Cerveza", hardHint: "Bebida" },
                { word: "MANGO", easyHint: "Peso", hardHint: "Moneda" },
                { word: "TRUCHO", easyHint: "Falso", hardHint: "Mentira" },
                { word: "GROSO", easyHint: "Grande", hardHint: "Importante" },
                { word: "ZAFAR", easyHint: "Escapar", hardHint: "Salvarse" }
            ],
            "categoria_privada": [
                // Drogas conocidas
                { word: "CANNABIS", easyHint: "Marihuana", hardHint: "Verde" },
                { word: "PORRO", easyHint: "Marihuana", hardHint: "Papel" },
                { word: "MERCA", easyHint: "Cocaína", hardHint: "Blanca" },
                { word: "FASO", easyHint: "Cigarrillo", hardHint: "Hierba" },
                { word: "PASTILLA", easyHint: "Éxtasis", hardHint: "Fiesta" },

                // Personajes históricos polémicos
                { word: "ESCOBAR", easyHint: "Pablo", hardHint: "Colombia" },
                { word: "CHAPO", easyHint: "Guzmán", hardHint: "México" },
                { word: "CAPONE", easyHint: "Al", hardHint: "Chicago" },

                // Eventos históricos
                { word: "TORRES", easyHint: "Gemelas", hardHint: "Septiembre" },
                { word: "TITANIC", easyHint: "Barco", hardHint: "Iceberg" },
                { word: "HIROSHIMA", easyHint: "Bomba", hardHint: "Japón" },
                { word: "CHERNOBYL", easyHint: "Nuclear", hardHint: "Reactor" },

                // Fútbol argentino polémico
                { word: "DESCENSO", easyHint: "River", hardHint: "B" },
                { word: "FANTASMA", easyHint: "B", hardHint: "Nacional" },
                { word: "BARRABRAVA", easyHint: "Hinchada", hardHint: "Violenta" },
                { word: "DOPING", easyHint: "Maradona", hardHint: "Mundial" },

                // Política argentina polémica
                { word: "CORRALITO", easyHint: "2001", hardHint: "Bancos" },
                { word: "HELICOPTERO", easyHint: "Presidencial", hardHint: "López" },
                { word: "INDULTOS", easyHint: "Menem", hardHint: "Perdón" },
                { word: "MALVERSACIÓN", easyHint: "Corrupción", hardHint: "Dinero" },

                // Temas actuales/woke
                { word: "FEMINISTA", easyHint: "Mujer", hardHint: "Igualdad" },
                { word: "MACHIRULO", easyHint: "Machista", hardHint: "Hombre" },
                { word: "VEGANO", easyHint: "Plantas", hardHint: "Animal" },
                { word: "AMBIENTALISTA", easyHint: "Planeta", hardHint: "Verde" },
                { word: "LIBERTARIO", easyHint: "Milei", hardHint: "Libre" },
                { word: "ZURDO", easyHint: "Izquierda", hardHint: "Comunista" },
                { word: "FACHO", easyHint: "Derecha", hardHint: "Fascista" },
                { word: "GLOBOLUDO", easyHint: "Clarín", hardHint: "Opositor" },
                { word: "PLANERO", easyHint: "Subsidio", hardHint: "Vago" },
                { word: "CHETO", easyHint: "Rico", hardHint: "Snob" }
            ],
            "futbolistas": [
                // Argentinos
                { word: "MESSI", easyHint: "Pulga", hardHint: "Rosario" },
                { word: "MARADONA", easyHint: "Diez", hardHint: "Dios" },
                { word: "DI MARÍA", easyHint: "Fideo", hardHint: "Ángel" },
                { word: "AGÜERO", easyHint: "Kun", hardHint: "Sergio" },
                { word: "HIGUAÍN", easyHint: "Pipita", hardHint: "Gonzalo" },
                { word: "MASCHERANO", easyHint: "Jefe", hardHint: "Javier" },
                { word: "RIQUELME", easyHint: "Román", hardHint: "Boca" },
                { word: "AIMAR", easyHint: "Payaso", hardHint: "Pablo" },
                { word: "TEVEZ", easyHint: "Apache", hardHint: "Carlos" },
                { word: "CRESPO", easyHint: "Valdanito", hardHint: "Hernán" },
                { word: "BATISTUTA", easyHint: "Batigol", hardHint: "Gabriel" },
                { word: "CANIGGIA", easyHint: "Pájaro", hardHint: "Claudio" },
                { word: "REDONDO", easyHint: "Príncipe", hardHint: "Fernando" },
                { word: "KEMPES", easyHint: "Matador", hardHint: "Mario" },
                { word: "PASSARELLA", easyHint: "Kaiser", hardHint: "Daniel" },
                // Internacionales muy famosos
                { word: "CRISTIANO", easyHint: "CR7", hardHint: "Portugal" },
                { word: "RONALDINHO", easyHint: "Dientes", hardHint: "Brasil" },
                { word: "PELÉ", easyHint: "Rey", hardHint: "Brasil" },
                { word: "NEYMAR", easyHint: "Junior", hardHint: "Brasil" },
                { word: "MBAPPÉ", easyHint: "Tortuga", hardHint: "Francia" },
                { word: "HAALAND", easyHint: "Robot", hardHint: "Noruega" },
                { word: "BENZEMA", easyHint: "Gato", hardHint: "Francia" },
                { word: "LEWANDOWSKI", easyHint: "Polaco", hardHint: "Robert" },
                { word: "SALAH", easyHint: "Egipcio", hardHint: "Mohamed" },
                { word: "MODRIC", easyHint: "Croata", hardHint: "Luka" }
            ],
            "peleadores": [
                // UFC Hombres
                { word: "MCGREGOR", easyHint: "Irlandés", hardHint: "Conor" },
                { word: "KHABIB", easyHint: "Águila", hardHint: "Daguestán" },
                { word: "JON JONES", easyHint: "Huesos", hardHint: "Campeón" },
                { word: "SILVA", easyHint: "Araña", hardHint: "Anderson" },
                { word: "GSP", easyHint: "Canadiense", hardHint: "Georges" },
                { word: "FEDOR", easyHint: "Ruso", hardHint: "Emperador" },
                { word: "CHUCK LIDDELL", easyHint: "Iceman", hardHint: "Chuck" },
                { word: "TITO ORTIZ", easyHint: "Huntington", hardHint: "Tito" },
                // UFC Mujeres
                { word: "RONDA ROUSEY", easyHint: "Judo", hardHint: "Ronda" },
                { word: "AMANDA NUNES", easyHint: "Leona", hardHint: "Brasil" },
                { word: "VALENTINA", easyHint: "Bala", hardHint: "Shevchenko" },
                { word: "ROSE NAMAJUNAS", easyHint: "Thug", hardHint: "Rose" },
                // Boxeo Hombres
                { word: "MIKE TYSON", easyHint: "Iron", hardHint: "Mike" },
                { word: "MUHAMMAD ALI", easyHint: "Grande", hardHint: "Float" },
                { word: "FLOYD", easyHint: "Money", hardHint: "Mayweather" },
                { word: "MANNY", easyHint: "Pacman", hardHint: "Pacquiao" },
                { word: "CANELO", easyHint: "Mexicano", hardHint: "Saúl" },
                { word: "ANTHONY JOSHUA", easyHint: "AJ", hardHint: "Inglés" },
                { word: "TYSON FURY", easyHint: "Gypsy", hardHint: "King" },
                // Boxeo Mujeres
                { word: "LAILA ALI", easyHint: "Hija", hardHint: "Muhammad" },
                { word: "CLARESSA SHIELDS", easyHint: "GWOAT", hardHint: "Claressa" },
                // Argentinos
                { word: "MARAVILLA", easyHint: "Martínez", hardHint: "Sergio" },
                { word: "CHINO MAIDANA", easyHint: "Marcos", hardHint: "Santa Fe" },
                { word: "BONADEO", easyHint: "Omar", hardHint: "Narváez" }
            ],
            "musica": [
                // Argentinos Rock/Pop
                { word: "CHARLY GARCÍA", easyHint: "Sui", hardHint: "Generis" },
                { word: "FITO PÁEZ", easyHint: "Ciudad", hardHint: "Baigón" },
                { word: "GUSTAVO CERATI", easyHint: "Soda", hardHint: "Stereo" },
                { word: "SPINETTA", easyHint: "Flaco", hardHint: "Luis" },
                { word: "ANDRÉS CALAMARO", easyHint: "Salmón", hardHint: "Andrés" },
                { word: "VICENTICO", easyHint: "Fabulosos", hardHint: "Cadillacs" },
                { word: "BERSUIT", easyHint: "Vergarabat", hardHint: "Banda" },
                { word: "LA RENGA", easyHint: "Chizzo", hardHint: "Rock" },
                { word: "DIVIDIDOS", easyHint: "Mollo", hardHint: "Ricardo" },
                { word: "RATA BLANCA", easyHint: "Metal", hardHint: "Giardino" },
                // Cuarteto/Folklore
                { word: "LA MONA", easyHint: "Jiménez", hardHint: "Córdoba" },
                { word: "RODRIGO", easyHint: "Potro", hardHint: "Cuarteto" },
                { word: "SOLEDAD", easyHint: "Folklore", hardHint: "Pastorutti" },
                { word: "CHAQUEÑO PALAVECINO", easyHint: "Folklore", hardHint: "Chaqueño" },
                { word: "ABEL PINTOS", easyHint: "Bahía", hardHint: "Blanca" },
                // Tango
                { word: "GARDEL", easyHint: "Zorzal", hardHint: "Carlos" },
                { word: "PIAZZOLLA", easyHint: "Astor", hardHint: "Bandoneón" },
                // Trap/Urbano Argentino
                { word: "BIZARRAP", easyHint: "Sessions", hardHint: "Biza" },
                { word: "DUKI", easyHint: "Trap", hardHint: "Mauro" },
                { word: "TRUENO", easyHint: "Freestyle", hardHint: "Mateo" },
                { word: "TINI", easyHint: "Stoessel", hardHint: "Martina" },
                { word: "MARIA BECERRA", easyHint: "Nena", hardHint: "María" },
                { word: "NATHY PELUSO", easyHint: "Buenos", hardHint: "Aires" },
                // Internacionales súper famosos
                { word: "MICHAEL JACKSON", easyHint: "Rey", hardHint: "Pop" },
                { word: "MADONNA", easyHint: "Reina", hardHint: "Pop" },
                { word: "QUEEN", easyHint: "Freddie", hardHint: "Mercury" },
                { word: "THE BEATLES", easyHint: "Liverpool", hardHint: "Cuatro" },
                { word: "ELVIS PRESLEY", easyHint: "Rey", hardHint: "Rock" },
                { word: "BOB MARLEY", easyHint: "Jamaica", hardHint: "Reggae" },
                { word: "SHAKIRA", easyHint: "Cadera", hardHint: "Colombia" },
                { word: "EMINEM", easyHint: "Rap", hardHint: "Marshall" },
                { word: "TAYLOR SWIFT", easyHint: "Country", hardHint: "Taylor" },
                { word: "ED SHEERAN", easyHint: "Pelirrojo", hardHint: "Shape" },
                { word: "ADELE", easyHint: "Rolling", hardHint: "Deep" },
                { word: "BEYONCÉ", easyHint: "Single", hardHint: "Ladies" },
                // Canciones súper famosas
                { word: "DESPACITO", easyHint: "Luis", hardHint: "Fonsi" },
                { word: "MACARENA", easyHint: "Baile", hardHint: "España" },
                { word: "GANGNAM STYLE", easyHint: "PSY", hardHint: "Corea" },
                { word: "BOHEMIAN RHAPSODY", easyHint: "Queen", hardHint: "Opera" }
            ],
            "libre_amigos": []
        };

        // Configuración de temáticas activas
        let activeThemes = {
            "comida_argentina": true,
            "bebidas_argentinas": true,
            "futbol_argentino": true,
            "lugares_argentina": true,
            "cordobes": true,
            "tango_folklore": true,
            "politica_historia": false,
            "transporte": false,
            "animales_pampa": false,
            "lunfardo_jerga": false,
            "categoria_privada": false,
            "futbolistas": false,
            "peleadores": false,
            "musica": false,
            "libre_amigos": false
        };

        // Estado de categoría privada
        let privateUnlocked = false;

        function setupPlayers() {
            const playerCount = parseInt(document.getElementById('player-count').value);
            const impostorCount = parseInt(document.getElementById('impostor-count').value);

            if (playerCount < 3 || playerCount > 10) {
                alert('El número de jugadores debe estar entre 3 y 10');
                return;
            }

            if (impostorCount >= playerCount) {
                alert('El número de impostores debe ser menor al de jugadores');
                return;
            }

            // Actualizar configuración de temáticas
            updateActiveThemes();

            // Verificar que al menos una temática esté activa
            const hasActiveThemes = Object.values(activeThemes).some(active => active);
            if (!hasActiveThemes) {
                alert('¡Debes seleccionar al menos una temática!');
                return;
            }

            const playerInputs = document.getElementById('player-inputs');
            playerInputs.innerHTML = '';

            for (let i = 1; i <= playerCount; i++) {
                const div = document.createElement('div');
                div.className = 'input-group';
                div.innerHTML = `
                    <label for="player-${i}">Jugador ${i}:</label>
                    <input type="text" id="player-${i}" placeholder="Nombre del jugador ${i}" required>
                `;
                playerInputs.appendChild(div);
            }

            showScreen('players-screen');
        }

        function updateActiveThemes() {
            // Actualizar el objeto activeThemes basado en los checkboxes
            Object.keys(activeThemes).forEach(theme => {
                const checkbox = document.getElementById(theme);
                if (checkbox) {
                    activeThemes[theme] = checkbox.checked;
                }
            });

            // Mostrar/ocultar botón de palabras personalizadas
            const customBtn = document.getElementById('custom-words-btn');
            const libreAmigosChecked = document.getElementById('libre_amigos').checked;
            customBtn.style.display = libreAmigosChecked ? 'block' : 'none';
        }

        function getRandomWordFromActiveThemes() {
            // Recopilar todas las palabras de las temáticas activas con su categoría
            const allWords = [];

            Object.keys(activeThemes).forEach(theme => {
                if (activeThemes[theme] && wordsByTheme[theme]) {
                    wordsByTheme[theme].forEach(wordObj => {
                        allWords.push({
                            ...wordObj,
                            category: theme
                        });
                    });
                }
            });

            if (allWords.length === 0) {
                // Fallback: usar comida argentina si no hay temáticas activas
                const fallbackWord = wordsByTheme.comida_argentina[0];
                return {
                    word: fallbackWord.word,
                    hint: fallbackWord.easyHint,
                    category: 'comida_argentina'
                };
            }

            const selectedWord = allWords[Math.floor(Math.random() * allWords.length)];

            // Determinar qué pista usar según la dificultad
            const difficulty = document.getElementById('difficulty').value;
            let hint;

            if (difficulty === 'easy') {
                hint = selectedWord.easyHint;
            } else if (difficulty === 'hard') {
                hint = selectedWord.hardHint;
            } else if (difficulty === 'impossible') {
                // Solo mostrar la categoría
                hint = categoryNames[selectedWord.category] || 'Categoría desconocida';
            }

            return {
                word: selectedWord.word,
                hint: hint,
                category: selectedWord.category
            };
        }

        // Función para manejar la categoría privada
        function togglePrivateCategory() {
            if (privateUnlocked) {
                // Ya está desbloqueada, ocultar
                privateUnlocked = false;
                document.querySelector('.private-theme').style.display = 'none';
                document.getElementById('private-btn').textContent = '🔒 Desbloquear Categoría Privada';
                activeThemes.categoria_privada = false;
                document.getElementById('categoria_privada').checked = false;
            } else {
                // Pedir contraseña
                const password = prompt('Ingresa la contraseña para desbloquear la categoría privada:');
                if (password === '1234') {
                    privateUnlocked = true;
                    document.querySelector('.private-theme').style.display = 'flex';
                    document.getElementById('private-btn').textContent = '🔓 Ocultar Categoría Privada';
                    alert('✅ Categoría privada desbloqueada. Úsala responsablemente con amigos cercanos.');

                    // Analytics: Track private category unlock
                    if (window.va) {
                        window.va('track', 'Private Category Unlocked');
                    }
                } else if (password !== null) {
                    alert('❌ Contraseña incorrecta');
                }
            }
        }

        function startGame() {
            const playerCount = parseInt(document.getElementById('player-count').value);
            const impostorCount = parseInt(document.getElementById('impostor-count').value);

            // Analytics: Track game start
            if (window.va) {
                window.va('track', 'Game Started', {
                    players: playerCount,
                    impostors: impostorCount,
                    difficulty: document.getElementById('difficulty').value
                });
            }

            // Recoger nombres de jugadores con validación
            gameState.players = [];
            const names = new Set();

            for (let i = 1; i <= playerCount; i++) {
                const name = document.getElementById(`player-${i}`).value.trim();
                if (!name) {
                    alert(`Por favor ingresa el nombre del jugador ${i}`);
                    return;
                }
                if (names.has(name.toLowerCase())) {
                    alert('No se permiten nombres repetidos');
                    return;
                }
                names.add(name.toLowerCase());
                gameState.players.push(name);
            }

            // Inicializar puntuaciones
            gameState.scores = {};
            gameState.players.forEach(player => {
                gameState.scores[player] = 0;
            });

            // Seleccionar impostores aleatoriamente usando Fisher-Yates
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            const shuffled = shuffle([...gameState.players]);
            gameState.impostors = shuffled.slice(0, impostorCount);

            // Seleccionar palabra aleatoria de las temáticas activas
            const randomWord = getRandomWordFromActiveThemes();
            gameState.currentWord = randomWord.word;
            gameState.currentHint = randomWord.hint;
            gameState.currentCategory = randomWord.category;

            // Reiniciar estado
            gameState.currentPlayerIndex = 0;
            gameState.votes = {};

            showRoles();
        }

        function showRoles() {
            document.getElementById('current-player-name').textContent =
                `Turno de: ${gameState.players[gameState.currentPlayerIndex]}`;
            document.getElementById('role-display').style.display = 'none';
            document.getElementById('current-player-info').style.display = 'block';
            setupRevealButton();
            showScreen('roles-screen');
        }

        function setupRevealButton() {
            const revealBtn = document.getElementById('reveal-btn');
            const revealProgress = document.getElementById('reveal-progress');
            const revealText = document.getElementById('reveal-text');

            let pressTimer = null;
            let progressTimer = null;
            let startTime = 0;
            const HOLD_DURATION = 500; // 0.5 segundos

            function startReveal() {
                if (pressTimer) return; // Ya está en proceso

                startTime = Date.now();
                revealText.textContent = 'Manteniendo...';

                // Vibración al iniciar (si está disponible)
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }

                progressTimer = setInterval(() => {
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min((elapsed / HOLD_DURATION) * 100, 100);
                    revealProgress.style.width = progress + '%';
                }, 16); // ~60fps

                pressTimer = setTimeout(() => {
                    revealProgress.style.width = '100%';
                    showRole();
                    if (navigator.vibrate) {
                        navigator.vibrate([100, 50, 100]);
                    }
                }, HOLD_DURATION);
            }

            function cancelReveal() {
                if (pressTimer) {
                    clearTimeout(pressTimer);
                    pressTimer = null;
                }
                if (progressTimer) {
                    clearInterval(progressTimer);
                    progressTimer = null;
                }
                revealProgress.style.width = '0%';
                revealText.textContent = 'Mantén Pulsado para Ver Rol';
            }

            // Touch events para móvil
            revealBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                startReveal();
            });

            revealBtn.addEventListener('touchend', (e) => {
                e.preventDefault();
                cancelReveal();
            });

            revealBtn.addEventListener('touchcancel', (e) => {
                e.preventDefault();
                cancelReveal();
            });

            // Mouse events para desktop
            revealBtn.addEventListener('mousedown', startReveal);
            revealBtn.addEventListener('mouseup', cancelReveal);
            revealBtn.addEventListener('mouseleave', cancelReveal);
        }

        function showRole() {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            const isImpostor = gameState.impostors.includes(currentPlayer);
            const roleCard = document.getElementById('role-card');

            document.getElementById('current-player-info').style.display = 'none';

            if (isImpostor) {
                roleCard.className = 'word-card impostor';
                roleCard.innerHTML = `
                    <div class="word">🎭 IMPOSTOR</div>
                    <div class="hint">¡Eres el impostor! Intenta pasar desapercibido.</div>
                    <div class="impostor-hint">
                        <strong>Pista sobre la palabra secreta:</strong><br>
                        ${gameState.currentHint}
                    </div>
                `;
            } else {
                roleCard.className = 'word-card';
                roleCard.innerHTML = `
                    <div class="word">🕵️ DETECTIVE</div>
                    <div class="hint">Tu palabra secreta es:</div>
                    <div class="word">${gameState.currentWord}</div>
                `;
            }

            document.getElementById('role-display').style.display = 'block';
        }

        function nextPlayer() {
            gameState.currentPlayerIndex++;
            if (gameState.currentPlayerIndex >= gameState.players.length) {
                startGameTimer();
                showScreen('game-screen');
            } else {
                showRoles();
            }
        }

        function startGameTimer() {
            const selectedTime = parseInt(document.getElementById('game-time').value);
            gameState.timeLeft = selectedTime;

            if (selectedTime === 0) {
                // Sin límite de tiempo
                document.getElementById('game-timer').textContent = 'Tiempo: ∞ Sin límite';
                return;
            }

            updateTimer();

            gameState.gameTimer = setInterval(() => {
                gameState.timeLeft--;
                updateTimer();

                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.gameTimer);
                    startVoting();
                }
            }, 1000);
        }

        function updateTimer() {
            const minutes = Math.floor(gameState.timeLeft / 60);
            const seconds = gameState.timeLeft % 60;
            const el = document.getElementById('game-timer');
            el.textContent = `Tiempo: ${minutes}:${seconds.toString().padStart(2, '0')}`;

            // Resaltar timer cuando queda poco tiempo (tema impostor)
            el.classList.toggle('low', gameState.timeLeft > 0 && gameState.timeLeft <= 20);

            // Mostrar botón de tiempo extra cuando queden menos de 30 segundos
            const addTimeBtn = document.getElementById('add-time-btn');
            if (gameState.timeLeft <= 30 && gameState.timeLeft > 0) {
                addTimeBtn.style.display = 'block';
            } else {
                addTimeBtn.style.display = 'none';
            }
        }

        function addMoreTime() {
            gameState.timeLeft += 120; // Agregar 2 minutos
            document.getElementById('add-time-btn').style.display = 'none';
            updateTimer();
        }

        function showHints() {
            document.getElementById('hint-content').innerHTML = `
                <strong>Pista para los impostores:</strong><br>
                ${gameState.currentHint}
                <br><br>
                <strong>Consejos:</strong><br>
                • Haz preguntas generales<br>
                • Copia las respuestas de otros<br>
                • No seas demasiado específico<br>
                • Mantén la calma
            `;
            showScreen('hints-screen');
        }

        function backToGame() {
            showScreen('game-screen');
        }

        function startVoting() {
            if (gameState.gameTimer) {
                clearInterval(gameState.gameTimer);
                gameState.gameTimer = null;
            }

            // Reiniciar sistema de votación completamente
            gameState.votes = {};
            gameState.votesCount = {};
            gameState.currentVoterIndex = 0;
            gameState.selectedVote = null;

            // Resetear elementos de la UI de votación
            document.getElementById('vote-buttons').style.display = 'block';
            document.getElementById('vote-summary').style.display = 'none';
            document.getElementById('vote-btn').style.display = 'block';
            document.getElementById('summary-btn').style.display = 'none';
            document.getElementById('voting-info').innerHTML = `
                <p>Votando: <span id="current-voter" aria-live="polite"></span></p>
                <p>¿Quién crees que es el impostor?</p>
            `;

            setupVotingRound();
            showScreen('voting-screen');
        }

        function setupVotingRound() {
            const currentVoter = gameState.players[gameState.currentVoterIndex];
            document.getElementById('current-voter').textContent = currentVoter;

            const voteButtons = document.getElementById('vote-buttons');
            voteButtons.innerHTML = '';

            gameState.players.forEach(player => {
                const button = document.createElement('button');
                button.className = 'vote-btn';
                button.textContent = player;
                button.setAttribute('role', 'button');
                button.setAttribute('aria-label', `Votar por ${player}`);

                // Efecto de highlight dinámico bajo el cursor/dedo
                button.onmousemove = (e) => {
                    const r = e.currentTarget.getBoundingClientRect();
                    const x = ((e.clientX - r.left) / r.width) * 100;
                    e.currentTarget.style.setProperty('--x', x + '%');
                };

                button.onclick = () => selectVote(player, button);
                voteButtons.appendChild(button);
            });

            document.getElementById('vote-btn').style.display = 'block';
            document.getElementById('summary-btn').style.display = 'none';
            document.getElementById('vote-summary').style.display = 'none';
            gameState.selectedVote = null;
        }

        function selectVote(player, buttonElement) {
            // Resetear estilos y clases
            document.querySelectorAll('.vote-btn').forEach(btn => {
                btn.classList.remove('selected');
                btn.setAttribute('aria-pressed', 'false');
            });

            // Marcar selección con clase para tema impostor
            buttonElement.classList.add('selected');
            buttonElement.setAttribute('aria-pressed', 'true');
            gameState.selectedVote = player;
        }

        function processVote() {
            if (!gameState.selectedVote) {
                alert('¡Debes seleccionar a alguien para votar!');
                return;
            }

            const currentVoter = gameState.players[gameState.currentVoterIndex];

            // Registrar voto
            const previousVote = gameState.votes[currentVoter];
            if (previousVote) {
                gameState.votesCount[previousVote] = (gameState.votesCount[previousVote] || 1) - 1;
            }

            gameState.votes[currentVoter] = gameState.selectedVote;
            gameState.votesCount[gameState.selectedVote] = (gameState.votesCount[gameState.selectedVote] || 0) + 1;

            // Siguiente votante
            gameState.currentVoterIndex++;

            if (gameState.currentVoterIndex >= gameState.players.length) {
                // Todos han votado
                document.getElementById('vote-btn').style.display = 'none';
                document.getElementById('summary-btn').style.display = 'block';
                document.getElementById('voting-info').innerHTML = '<p>¡Todos han votado!</p>';
                document.getElementById('vote-buttons').style.display = 'none';
            } else {
                setupVotingRound();
            }
        }

        function showVoteSummary() {
            const voteCounts = document.getElementById('vote-counts');
            voteCounts.innerHTML = '';

            const sortedVotes = Object.entries(gameState.votesCount)
                .filter(([_, count]) => count > 0)
                .sort(([, a], [, b]) => b - a);

            sortedVotes.forEach(([player, count]) => {
                const item = document.createElement('div');
                item.className = 'vote-summary-item';
                item.innerHTML = `<span>${player}</span><span>${count} voto${count !== 1 ? 's' : ''}</span>`;
                voteCounts.appendChild(item);
            });

            document.getElementById('vote-summary').style.display = 'block';
            document.getElementById('summary-btn').textContent = 'Continuar';
            document.getElementById('summary-btn').onclick = showResults;
        }

        function showResults() {
            const sortedVotes = Object.entries(gameState.votesCount)
                .filter(([_, count]) => count > 0)
                .sort(([, a], [, b]) => b - a);

            if (sortedVotes.length === 0) {
                alert('¡No hay votos registrados!');
                return;
            }

            const [votedPlayer, votes] = sortedVotes[0];
            const tie = sortedVotes.length > 1 && sortedVotes[1][1] === votes;

            if (tie) {
                alert('¡Hay empate! Discutan más y vuelvan a votar.');
                startVoting();
                return;
            }

            const isImpostorVoted = gameState.impostors.includes(votedPlayer);
            const resultsContent = document.getElementById('results-content');

            // Analytics: Track game end
            if (window.va) {
                window.va('track', 'Game Ended', {
                    result: isImpostorVoted ? 'Detectives Win' : 'Impostor Win',
                    players: gameState.players.length,
                    impostors: gameState.impostors.length,
                    votedPlayer: votedPlayer,
                    votes: votes
                });
            }

            if (isImpostorVoted) {
                resultsContent.innerHTML = `
                    <div class="word-card success">
                        <div class="word">🎉 ¡VICTORIA!</div>
                        <div class="hint">¡Detectaron al impostor!</div>
                        <p><strong>${votedPlayer}</strong> era el impostor</p>
                        <p>Recibió ${votes} voto${votes !== 1 ? 's' : ''}</p>
                        <p>La palabra secreta era: <strong>${gameState.currentWord}</strong></p>
                    </div>
                `;

                // Dar puntos a los detectives
                gameState.players.forEach(player => {
                    if (!gameState.impostors.includes(player)) {
                        gameState.scores[player] += 10;
                    }
                });
            } else {
                resultsContent.innerHTML = `
                    <div class="word-card fail">
                        <div class="word">😈 ¡DERROTA!</div>
                        <div class="hint">¡El impostor escapó!</div>
                        <p><strong>${votedPlayer}</strong> no era el impostor</p>
                        <p>Recibió ${votes} voto${votes !== 1 ? 's' : ''}</p>
                        <p>Los impostores eran: <strong>${gameState.impostors.join(', ')}</strong></p>
                        <p>La palabra secreta era: <strong>${gameState.currentWord}</strong></p>
                    </div>
                `;

                // Dar puntos a los impostores
                gameState.impostors.forEach(impostor => {
                    gameState.scores[impostor] += 15;
                });
            }

            saveGameData();
            updateScoreBoard();
            showScreen('results-screen');
        }

        function updateScoreBoard() {
            const scoreBoard = document.getElementById('score-board');
            const sortedPlayers = Object.entries(gameState.scores)
                .sort(([, a], [, b]) => b - a);

            let html = '<h3>🏆 Puntuaciones</h3>';
            sortedPlayers.forEach(([player, score], index) => {
                const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : '🏅';
                html += `
                    <div class="score-item">
                        <span>${medal} ${player}</span>
                        <span>${score} pts</span>
                    </div>
                `;
            });

            scoreBoard.innerHTML = html;
        }

        function playAgain() {
            // Limpiar timer anterior si existe
            if (gameState.gameTimer) {
                clearInterval(gameState.gameTimer);
                gameState.gameTimer = null;
            }

            // Mantener jugadores y puntuaciones, pero reiniciar completamente el estado del juego
            gameState.currentPlayerIndex = 0;
            gameState.currentVoterIndex = 0;
            gameState.votes = {};
            gameState.votesCount = {};
            gameState.selectedVote = null;
            gameState.timeLeft = parseInt(document.getElementById('game-time').value);

            // Nueva palabra y nuevos impostores
            const impostorCount = gameState.impostors.length;
            const shuffled = [...gameState.players].sort(() => 0.5 - Math.random());
            gameState.impostors = shuffled.slice(0, impostorCount);

            const randomWord = getRandomWordFromActiveThemes();
            gameState.currentWord = randomWord.word;
            gameState.currentHint = randomWord.hint;
            gameState.currentCategory = randomWord.category;

            // Resetear elementos de la UI de votación
            document.getElementById('vote-buttons').style.display = 'block';
            document.getElementById('vote-summary').style.display = 'none';
            document.getElementById('vote-btn').style.display = 'block';
            document.getElementById('summary-btn').style.display = 'none';
            document.getElementById('voting-info').innerHTML = `
                <p>Votando: <span id="current-voter" aria-live="polite"></span></p>
                <p>¿Quién crees que es el impostor?</p>
            `;

            showRoles();
        }

        function goHome() {
            if (gameState.gameTimer) {
                clearInterval(gameState.gameTimer);
            }
            showScreen('home-screen');
        }

        function showScreen(screenId) {
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        // Actualizar opciones de impostores según número de jugadores
        document.getElementById('player-count').addEventListener('change', function () {
            const playerCount = parseInt(this.value);
            const impostorSelect = document.getElementById('impostor-count');

            // A partir de 6 jugadores se permite 2 impostores
            let maxImpostors = 1;
            if (playerCount >= 6) {
                maxImpostors = 2;
            }
            if (playerCount >= 9) {
                maxImpostors = 3;
            }

            impostorSelect.innerHTML = '';
            for (let i = 1; i <= maxImpostors; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${i} impostor${i > 1 ? 'es' : ''}`;
                impostorSelect.appendChild(option);
            }
        });

        // Función para mostrar instrucciones
        function showHowToPlay() {
            showScreen('how-to-play-screen');
        }

        // Función para ocultar instrucciones en pantalla principal
        function hideInstructions() {
            const instructions = document.getElementById('game-instructions');
            instructions.style.display = 'none';

            // Guardar preferencia
            localStorage.setItem('hideInstructions', 'true');
        }

        // Función para mostrar instrucciones si no se han ocultado
        function checkInstructionsVisibility() {
            const hideInstructions = localStorage.getItem('hideInstructions');
            const instructions = document.getElementById('game-instructions');

            if (hideInstructions === 'true') {
                instructions.style.display = 'none';
            } else {
                instructions.style.display = 'block';
            }
        }

        // Funciones para manejar palabras personalizadas
        function showCustomWords() {
            loadCustomWords();
            showScreen('custom-words-screen');
        }

        function addCustomWord() {
            const word = document.getElementById('custom-word').value.trim().toUpperCase();
            const easyHint = document.getElementById('custom-easy-hint').value.trim();
            const hardHint = document.getElementById('custom-hard-hint').value.trim();

            if (!word || !easyHint || !hardHint) {
                alert('¡Completa todos los campos!');
                return;
            }

            if (word.length > 30) {
                alert('La palabra es muy larga (máximo 30 caracteres)');
                return;
            }

            // Verificar si ya existe
            const exists = wordsByTheme.libre_amigos.some(item => item.word === word);
            if (exists) {
                alert('Esta palabra ya existe');
                return;
            }

            // Agregar palabra
            wordsByTheme.libre_amigos.push({
                word: word,
                easyHint: easyHint,
                hardHint: hardHint
            });

            // Analytics: Track custom word added
            if (window.va) {
                window.va('track', 'Custom Word Added', {
                    totalCustomWords: wordsByTheme.libre_amigos.length
                });
            }

            // Limpiar campos
            document.getElementById('custom-word').value = '';
            document.getElementById('custom-easy-hint').value = '';
            document.getElementById('custom-hard-hint').value = '';

            // Actualizar lista y guardar
            loadCustomWords();
            saveGameData();
        }

        function loadCustomWords() {
            const container = document.getElementById('custom-words-container');
            container.innerHTML = '';

            if (wordsByTheme.libre_amigos.length === 0) {
                container.innerHTML = '<p style="opacity: 0.7; text-align: center;">No hay palabras personalizadas aún</p>';
                return;
            }

            wordsByTheme.libre_amigos.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'custom-word-item';
                div.innerHTML = `
                    <div class="custom-word-info">
                        <strong>${item.word}</strong>
                        <small>Fácil: ${item.easyHint}</small>
                        <small>Difícil: ${item.hardHint}</small>
                    </div>
                    <div class="custom-word-actions">
                        <button class="btn btn-small btn-danger" onclick="removeCustomWord(${index})">🗑️ Eliminar</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function removeCustomWord(index) {
            if (confirm('¿Eliminar esta palabra personalizada?')) {
                wordsByTheme.libre_amigos.splice(index, 1);
                loadCustomWords();
                saveGameData();
            }
        }

        // ===== Sistema de pistas genéricas V3 =====
        const themeFallback = {
            comida_argentina: "comida",
            bebidas_argentinas: "bebida",
            futbol_argentino: "fútbol",
            lugares_argentina: "lugar",
            cordobes: "cultura",
            tango_folklore: "tradición",
            politica_historia: "historia",
            transporte: "movilidad",
            animales_pampa: "animal",
            lunfardo_jerga: "jerga",
            categoria_privada: "tema sensible",
            futbolistas: "jugador",
            peleadores: "lucha",
            musica: "música",
            libre_amigos: "personal"
        };

        // Nombres amigables de categorías para dificultad "Imposible"
        const categoryNames = {
            comida_argentina: "Comida Argentina",
            bebidas_argentinas: "Bebidas Argentinas",
            futbol_argentino: "Fútbol Argentino",
            lugares_argentina: "Lugares de Argentina",
            cordobes: "Córdoba",
            tango_folklore: "Tango y Folklore",
            politica_historia: "Política e Historia",
            transporte: "Transporte",
            animales_pampa: "Animales de la Pampa",
            lunfardo_jerga: "Lunfardo y Jerga",
            categoria_privada: "Categoría Privada",
            futbolistas: "Futbolistas",
            peleadores: "Peleadores",
            musica: "Música",
            libre_amigos: "Libre Amigos"
        };

        const wordOverrides = {
            // Fútbol argentino
            "BOMBONERA": "estadio",
            "MONUMENTAL": "estadio",
            "SUPERCLÁSICO": "partido",
            "BOCA": "equipo",
            "RIVER": "equipo",
            "ESTUDIANTES": "equipo",
            "RACING": "equipo",
            "INDEPENDIENTE": "equipo",
            "HURACÁN": "equipo",
            "LANÚS": "equipo",
            "TALLERES": "equipo",
            "BELGRANO": "equipo",
            "INSTITUTO": "equipo",
            "MARADONA": "jugador",
            "MESSI": "jugador",

            // Lugares
            "IGUAZÚ": "naturaleza",
            "CALAFATE": "naturaleza",
            "PENÍNSULA": "naturaleza",
            "ACONCAGUA": "montaña",
            "OBELISCO": "monumento",
            "RECOLETA": "barrio",
            "CAMINITO": "paseo",
            "BARILOCHE": "ciudad",
            "MENDOZA": "ciudad",
            "SALTA": "ciudad",
            "USHUAIA": "ciudad",
            "ROSARIO": "ciudad",
            "CAFAYATE": "viñedo",
            "TIGRE": "delta",
            "TILCARA": "valle",

            // Córdoba
            "CUARTETO": "música",
            "MONA": "artista",
            "SIERRAS": "lugar",
            "CHAMUYAR": "jerga",
            "CULIAU": "jerga",
            "BOLUDO": "jerga",
            "BONDI": "transporte",
            "BIRRA": "bebida",
            "ASADITO": "comida",
            "COSQUÍN": "festival",

            // Tango / Folklore
            "GARDEL": "tango",
            "BANDONEÓN": "instrumento",
            "MILONGA": "baile",
            "PIAZZOLLA": "tango",
            "CHACARERA": "baile",
            "ZAMBA": "baile",
            "VIDALA": "canto",
            "MALAMBO": "baile",
            "PAYADOR": "canto",
            "GAUCHO": "tradición",
            "FACÓN": "objeto",
            "PONCHO": "ropa",
            "ALPARGATAS": "calzado",
            "BOMBACHA": "ropa",
            "BOINA": "ropa",

            // Transporte
            "SUBTE": "vehículo",
            "COLECTIVO": "vehículo",
            "REMISE": "servicio",
            "TAXI": "servicio",
            "TREN": "vehículo",
            "COMBI": "vehículo",
            "TROLEBÚS": "vehículo",
            "LANCHA": "vehículo",
            "AVIÓN": "vehículo",
            "MOTO": "vehículo",
            "BICICLETA": "vehículo",
            "UBER": "servicio",
            "CABIFY": "servicio",
            "METROBUS": "corredor",
            "PEAJE": "pago",

            // Animales
            "CARPINCHO": "animal",
            "HORNERO": "animal",
            "ÑANDÚ": "animal",
            "VIZCACHA": "animal",
            "CHIMANGO": "animal",
            "BENTEVEO": "animal",
            "TERO": "animal",
            "CARANCHO": "animal",
            "MARTINETA": "animal",
            "MULITA": "animal",
            "ZORRINO": "animal",
            "COMADREJA": "animal",
            "LIEBRE": "animal",
            "YACARÉ": "animal",
            "DORADO": "animal",

            // Lunfardo
            "LABURO": "jerga",
            "GUITA": "jerga",
            "PIBE": "jerga",
            "MINA": "jerga",
            "CHABON": "jerga",
            "MORFAR": "jerga",
            "FIACA": "jerga",
            "QUILOMBO": "jerga",
            "MANGO": "jerga",
            "TRUCHO": "jerga",
            "GROSO": "jerga",
            "ZAFAR": "jerga",

            // Política / Historia
            "CABILDO": "edificio",
            "CONGRESO": "edificio",
            "CASA": "edificio",
            "MAYO": "fecha",
            "INDEPENDENCIA": "evento",
            "MALVINAS": "historia",
            "EVITA": "historia",
            "PERÓN": "historia",
            "BELGRANO": "historia",
            "SARMIENTO": "historia",
            "ROCA": "historia",
            "YRIGOYEN": "historia",
            "LIBERTADOR": "historia",
            "CRUZADA": "historia",

            // Futbolistas
            "DI MARÍA": "jugador",
            "AGÜERO": "jugador",
            "HIGUAÍN": "jugador",
            "MASCHERANO": "jugador",
            "RIQUELME": "jugador",
            "AIMAR": "jugador",
            "TEVEZ": "jugador",
            "CRESPO": "jugador",
            "BATISTUTA": "jugador",
            "CANIGGIA": "jugador",
            "REDONDO": "jugador",
            "KEMPES": "jugador",
            "PASSARELLA": "jugador",
            "CRISTIANO": "jugador",
            "RONALDINHO": "jugador",
            "PELÉ": "jugador",
            "NEYMAR": "jugador",
            "MBAPPÉ": "jugador",
            "HAALAND": "jugador",
            "BENZEMA": "jugador",
            "LEWANDOWSKI": "jugador",
            "SALAH": "jugador",
            "MODRIC": "jugador",

            // Peleadores
            "MCGREGOR": "lucha",
            "KHABIB": "lucha",
            "JON JONES": "lucha",
            "SILVA": "lucha",
            "GSP": "lucha",
            "FEDOR": "lucha",
            "CHUCK LIDDELL": "lucha",
            "TITO ORTIZ": "lucha",
            "RONDA ROUSEY": "lucha",
            "AMANDA NUNES": "lucha",
            "VALENTINA": "lucha",
            "ROSE NAMAJUNAS": "lucha",
            "MIKE TYSON": "boxeo",
            "MUHAMMAD ALI": "boxeo",
            "FLOYD": "boxeo",
            "MANNY": "boxeo",
            "CANELO": "boxeo",
            "ANTHONY JOSHUA": "boxeo",
            "TYSON FURY": "boxeo",
            "LAILA ALI": "boxeo",
            "CLARESSA SHIELDS": "boxeo",
            "MARAVILLA": "boxeo",
            "CHINO MAIDANA": "boxeo",
            "NARVÁEZ": "boxeo",

            // Música
            "DUKI": "palabras",
            "ABEL PINTOS": "romance",
            "CHARLY GARCÍA": "artista",
            "FITO PÁEZ": "artista",
            "GUSTAVO CERATI": "artista",
            "SPINETTA": "artista",
            "ANDRÉS CALAMARO": "artista",
            "VICENTICO": "artista",
            "BERSUIT": "banda",
            "LA RENGA": "banda",
            "DIVIDIDOS": "banda",
            "RATA BLANCA": "banda",
            "LA MONA": "artista",
            "RODRIGO": "artista",
            "SOLEDAD": "artista",
            "CHAQUEÑO PALAVECINO": "artista",
            "BIZARRAP": "palabras",
            "TRUENO": "palabras",
            "TINI": "pop",
            "MARIA BECERRA": "pop",
            "NATHY PELUSO": "artista",
            "MICHAEL JACKSON": "pop",
            "MADONNA": "pop",
            "QUEEN": "banda",
            "THE BEATLES": "banda",
            "ELVIS PRESLEY": "rock",
            "BOB MARLEY": "reggae",
            "SHAKIRA": "pop",
            "EMINEM": "palabras",
            "TAYLOR SWIFT": "pop",
            "ED SHEERAN": "pop",
            "ADELE": "balada",
            "BEYONCÉ": "pop",
            "DESPACITO": "canción",
            "MACARENA": "canción",
            "GANGNAM STYLE": "canción",
            "BOHEMIAN RHAPSODY": "canción"
        };

        // Función para aplicar el sistema de pistas V3
        function applyHardHintsV3() {
            // Primero corregir BONADEO por NARVÁEZ en peleadores
            const peleadores = wordsByTheme.peleadores;
            if (peleadores) {
                const bonadeoIndex = peleadores.findIndex(item => item.word === "BONADEO");
                if (bonadeoIndex !== -1) {
                    peleadores[bonadeoIndex] = { word: "NARVÁEZ", easyHint: "Omar", hardHint: "boxeo" };
                }
            }

            // Aplicar cambios a todas las categorías
            Object.entries(wordsByTheme).forEach(([theme, list]) => {
                const fallback = themeFallback[theme] || "tema";

                list.forEach(item => {
                    // Mover hardHint actual a easyHint
                    item.easyHint = item.hardHint;

                    // Aplicar nueva hardHint genérica
                    const override = wordOverrides[item.word];
                    item.hardHint = override || fallback;

                    // Sanitizar: máximo 2 palabras
                    const sanitized = item.hardHint.trim().split(/\s+/).slice(0, 2).join(" ");

                    // Verificar que no contenga la palabra objetivo
                    const normalizedWord = item.word.normalize("NFD").replace(/\p{Diacritic}/gu, "").toLowerCase();
                    const normalizedHint = sanitized.normalize("NFD").replace(/\p{Diacritic}/gu, "").toLowerCase();

                    item.hardHint = normalizedHint.includes(normalizedWord) ? fallback : sanitized;
                });
            });
        }

        // ===== FUNCIONES PWA PARA INSTALACIÓN =====
        
        // Función para instalar el juego
        function installGame() {
            if (deferredPrompt) {
                // Mostrar el prompt de instalación
                deferredPrompt.prompt();
                
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('Usuario aceptó instalar la PWA');
                        // Analytics
                        if (window.va) {
                            window.va('track', 'PWA Install Accepted');
                        }
                    } else {
                        console.log('Usuario rechazó instalar la PWA');
                    }
                    deferredPrompt = null;
                    updateInstallButton();
                });
            } else {
                // Mostrar instrucciones manuales
                showInstallInstructions();
            }
        }
        
        // Mostrar instrucciones de instalación manual
        function showInstallInstructions() {
            const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            const isAndroid = /Android/.test(navigator.userAgent);
            
            let instructions = '';
            
            if (isIOS) {
                instructions = `
                    📱 Para instalar en iPhone/iPad:
                    
                    1. Toca el botón "Compartir" (⬆️)
                    2. Selecciona "Agregar a pantalla de inicio"
                    3. Toca "Agregar"
                    
                    ¡Tu juego aparecerá como una app!
                `;
            } else if (isAndroid) {
                instructions = `
                    📱 Para instalar en Android:
                    
                    1. Toca el menú (⋮) del navegador
                    2. Selecciona "Agregar a pantalla de inicio"
                    3. Toca "Agregar"
                    
                    ¡Tu juego aparecerá como una app!
                `;
            } else {
                instructions = `
                    💻 Para instalar en tu computadora:
                    
                    1. Busca el ícono de instalación (⬇️) en la barra de direcciones
                    2. Haz clic en "Instalar Impostor"
                    3. Confirma la instalación
                    
                    También puedes usar: Menú → Instalar Impostor
                `;
            }
            
            alert(instructions);
        }
        
        // Actualizar el estado del botón de instalación
        function updateInstallButton() {
            const installBtn = document.getElementById('install-btn');
            if (!installBtn) return;
            
            if (deferredPrompt) {
                installBtn.style.display = 'block';
                installBtn.innerHTML = '📱 Descargar Juego';
                installBtn.title = 'Instalar como aplicación nativa';
            } else if (window.matchMedia('(display-mode: standalone)').matches) {
                // Ya está instalado
                installBtn.style.display = 'none';
            } else {
                // Mostrar con instrucciones manuales
                installBtn.style.display = 'block';
                installBtn.innerHTML = '📲 Instalar Juego';
                installBtn.title = 'Ver instrucciones de instalación';
            }
        }
        
        // Event listeners para PWA
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevenir que Chrome 67 y anteriores muestren automáticamente el prompt
            e.preventDefault();
            
            // Guardar el evento para poder usarlo después
            deferredPrompt = e;
            
            // Mostrar el botón de instalación
            updateInstallButton();
            
            console.log('PWA: Install prompt disponible');
        });
        
        window.addEventListener('appinstalled', (evt) => {
            console.log('PWA: App instalada exitosamente');
            updateInstallButton();
            
            // Analytics
            if (window.va) {
                window.va('track', 'PWA Installed Successfully');
            }
            
            // Mostrar mensaje de éxito
            setTimeout(() => {
                alert('🎉 ¡Impostor instalado exitosamente!\n\nYa puedes encontrar el juego en tu pantalla de inicio.');
            }, 1000);
        });

        // Inicialización al cargar la página
        document.addEventListener('DOMContentLoaded', function () {
            // Aplicar sistema de pistas V3
            applyHardHintsV3();

            loadGameData();

            // Verificar visibilidad de instrucciones
            checkInstructionsVisibility();

            // Disparar el evento change para configurar impostores iniciales
            document.getElementById('player-count').dispatchEvent(new Event('change'));

            // Agregar event listeners para los checkboxes de temáticas
            Object.keys(activeThemes).forEach(theme => {
                const checkbox = document.getElementById(theme);
                if (checkbox) {
                    checkbox.addEventListener('change', updateActiveThemes);
                }
            });

            // Inicializar visibilidad del botón de palabras personalizadas
            updateActiveThemes();

            // Inicializar botón de instalación PWA
            setTimeout(updateInstallButton, 1000);

            // Registrar Service Worker para PWA
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => console.log('SW registrado:', registration.scope))
                    .catch(error => console.log('Error registrando SW:', error));
            }
        });
    </script>
</body>

</html>